<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin - Card List</title>
    <link rel="stylesheet" href="/css/card-list.css" />
    <style>
      * {
        box-sizing: border-box;
      }
      .admin-header {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      
      /* ëª¨ë°”ì¼ ëŒ€ì‘ */
      @media (max-width: 768px) {
        .admin-header {
          flex-direction: column;
          gap: 15px;
          align-items: flex-start;
        }
        .admin-header h1 {
          font-size: 1.3em;
        }
        .admin-actions {
          flex-direction: column;
          width: 100%;
        }
        .admin-btn {
          width: 100%;
          text-align: center;
        }
        .stats-bar {
          flex-direction: column;
          gap: 10px;
          align-items: flex-start !important;
        }
        body {
          padding: 10px;
        }
      }
      .admin-header h1 {
        margin: 0;
        color: #4338ca;
      }
      .admin-actions {
        display: flex;
        gap: 10px;
      }
      .admin-btn {
        padding: 10px 20px;
        background: #4338ca;
        color: white;
        text-decoration: none;
        border-radius: 8px;
        font-weight: bold;
        transition: background-color 0.3s;
      }
      .admin-btn:hover {
        background: #3730a3;
      }
      .admin-btn.secondary {
        background: #6b7280;
      }
      .admin-btn.secondary:hover {
        background: #4b5563;
      }
      .stats-bar {
        max-width: 1200px;
        margin: 0 auto 30px;
        padding: 0 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .stats-info {
        font-size: 1.1em;
        color: #666;
      }
      .stats-info b {
        color: #4338ca;
        font-size: 1.2em;
      }
    </style>
  </head>
  <body>
    <div class="admin-header">
      <h1>ğŸ“‹ ê´€ë¦¬ì - ì¹´ë“œ ëª©ë¡</h1>
      <div class="admin-actions">
        <a href="/admin/cards/register" class="admin-btn">ì¹´ë“œ ë“±ë¡</a>
        <a href="/cards" class="admin-btn secondary">ì¼ë°˜ ëª©ë¡ ë³´ê¸°</a>
      </div>
    </div>

    <div class="stats-bar">
      <div class="stats-info">
        ì´ ë“±ë¡ëœ ì¹´ë“œ: <b th:text="${cards.size()}">0</b>ê°œ
      </div>
    </div>

    <main>
      <div class="card-grid">
        <div
          class="card-item"
          th:each="card : ${cards}"
          th:data-card-id="${card.id}"
          th:data-card-category="${card.category}"
        >
          <div class="card-image" th:onclick="|handleAdminCardClick(${card.id}, '${card.category != null ? card.category : ''}')|" style="cursor: pointer;">
            <img th:src="${card.imageUrl}" th:alt="${card.name}" />
          </div>
          <div class="card-info">
            <h3 th:text="${card.name}" th:onclick="|handleAdminCardClick(${card.id}, '${card.category != null ? card.category : ''}')|" style="cursor: pointer;">Card Name</h3>
            <p class="set-name" th:text="${card.setName}">Set Name</p>
            <div class="meta">
              <span class="rarity" th:text="${card.rarity}">Rarity</span>
              <span class="price" th:text="${card.priceDisplay}">Price</span>
            </div>
            <div class="admin-actions" style="margin-top: 10px; display: flex; gap: 8px; justify-content: center;">
              <a th:href="@{${card.category == 'ONEPIECE_BOX' ? '/admin/onepiece-boxes/edit/' : '/admin/cards/edit/'}{id}(id=${card.id})}" 
                 class="btn-edit" 
                 style="padding: 6px 12px; background: #4338ca; color: white; text-decoration: none; border-radius: 5px; font-size: 0.85em;"
                 onclick="event.stopPropagation();">ìˆ˜ì •</a>
              <form th:action="@{${card.category == 'ONEPIECE_BOX' ? '/admin/onepiece-boxes/delete/' : '/admin/cards/delete/'}{id}(id=${card.id})}" 
                    method="post" 
                    style="display: inline;"
                    onsubmit="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');"
                    onclick="event.stopPropagation();">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <button type="submit" 
                        class="btn-delete" 
                        style="padding: 6px 12px; background: #dc2626; color: white; border: none; border-radius: 5px; font-size: 0.85em; cursor: pointer;">
                  ì‚­ì œ
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>

      <div th:if="${cards.isEmpty()}" class="empty-state">
        <p>ë“±ë¡ëœ ì¹´ë“œê°€ ì—†ìŠµë‹ˆë‹¤. "ì¹´ë“œ ë“±ë¡" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì¹´ë“œë¥¼ ë“±ë¡í•˜ì„¸ìš”.</p>
      </div>
    </main>

    <script src="/js/app.bundle.js"></script>
    <script>
      // ê´€ë¦¬ì ì¹´ë“œ ëª©ë¡ í˜ì´ì§€ì—ì„œ ì¹´ë“œ í´ë¦­ í•¸ë“¤ëŸ¬
      function handleAdminCardClick(cardId, category) {
        if (!cardId) return;
        
        // ì›í”¼ìŠ¤ Boxì¸ ê²½ìš° ë³„ë„ ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™
        if (category === 'ONEPIECE_BOX') {
          window.location.href = '/onepiece-boxes/' + cardId;
        } else {
          // ì¼ë°˜ ì¹´ë“œì¸ ê²½ìš° ì¹´ë“œ ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™
          window.location.href = '/cards/' + cardId;
        }
      }
    </script>
  </body>
</html>

